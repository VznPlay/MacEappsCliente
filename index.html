<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Mac's  - Grupo Vznplay</title>
    <link rel="icon" href="favicon-32x32.png" type="image/x-icon">

<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#0a1a63;">
<link rel="apple-touch-icon" href="/logo-01.png">


    <!-- Adicionando a biblioteca jsPDF para exportar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <!-- Adicionando a biblioteca SheetJS para exportar Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<!-- C√≥digo do Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0N6D6EWQ33"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-0N6D6EWQ33');
</script>

<style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #333333;
            color: #fff;
            flex-direction: column;
        }

/* Estilos para a faixa */

.banner {
    width: 100%;
    height: 45px;
    background-color: #0073e6;
    color: white;
    overflow: hidden;
    position: relative;
    margin-bottom: 10px;
}
.marquee {
    display: flex;
    position: absolute;
    height: 100%;
    align-items: center;
}
.marquee-container {
    display: flex;
    animation: marquee 30s linear infinite;
}
.marquee-text {
    white-space: nowrap;
    flex-shrink: 0;
    padding: 0 8px; /* Espa√ßo entre os textos */
}
@keyframes marquee {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
}
.marquee a {
    color: #ffdd00;
    font-weight: bold;
    text-decoration: none;
}
.marquee a:hover {
    text-decoration: underline;
}

        .container {
            width: 100%;
            max-width: 700px; /* Aumentado para ampliar o quadrado do meio */
            padding: 20px;
            background-color: #12233d;
            border-radius: 10px;
            text-align: center;
        }

        h1 {
            margin-bottom: 20px;
            font-size: 2.4em;
        }

        form {
            display: flex;
            flex-direction: column;
        }

        .row {
            display: flex;
            gap: 10px;
        }

        input[type="text"] {
            padding: 12px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            margin-bottom: 15px;
            text-transform: capitalize;
            width: 100%;
        }

        input::placeholder {
            color: #555;
        }

        .separator {
            display: flex;
            gap: 10px;
            justify-content: space-between;
        }

        .separator div {
            flex: 1;
            height: 1px;
            background-color: #fff;
        }

        button {
            padding: 10px;
            font-size: 1em;
            font-weight: bold;
            border: none;
            color: #ffffff;
            border-radius: 5px;
            cursor: pointer;
        }

        .add-btn {
            background-color: #15ff00;
            color: black;
            font-weight: bold;
            font-size: 1.4em;
        }

        .delete-btn {
            background-color: #FF0000;
            margin-top: 10px;
            padding: 8px 12px;
        }

        .success-message {
            margin-top: 10px;
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
            font-size: 1.8em;
            color: #4CAF50;
            display: none;
        }

        .search-box {
            padding: 10px;
            font-size: 1em;
            border-radius: 5px;
            margin-top: 10px;
        }

        .data-list {
            margin-top: 10px; /* Reduzido o espa√ßamento superior */
            width: 100%;
            background-color: #ffffff;
            color: #000;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 1em; /* Tamanho menor para melhor responsividade */
            max-width: 100%;
        }

        .data-list h2 {
            margin-bottom: 10px;
        }

        .data-list table {
            width: 100%;
            border-collapse: collapse;
            color: #000;
            background-color: #ffffff;
            table-layout: fixed; /* Limita a largura das c√©lulas */
        }

        .data-list th, .data-list td {
            border: 1px solid #ddd;
            padding: 8px 2px 8px 2px;
            text-align: center;
            word-wrap: break-word;
            font-size: .8em; /* Ajusta o tamanho do texto na tabela */
        }

        .data-list th {
            background-color: #ff9100;
        }



/* CODIGO ABAIXO E DOS OUTROS SITES*/
.catalogo {
    display: flex;
    gap: 2px;
}
.sug{
    margin-right: 3px;
}
section {
    background-color:rgb(42, 99, 45); /* Azul forte */
    padding: 3px;
    display: flex;
    border: 2px solid #333; /* Borda para destaque */
    color: #fff; /* Cor do texto para contraste */
    border-radius: 7px;
}
section a {
    text-decoration: none;
    color: #ffffff;
    font-size: 14px;
    text-align: center;
}
.icon {
    width: 48px;
    height: 45px;

}
#fatu{
    width: 40px;
    height: 40px;
    margin-bottom: 5px;
}
.fotos{
    width: 70px;
    height: 50px;
    margin-top: -5px;
}
.foto{
    width: 50px;
    height: 50px;
    margin-top: -5px;
}
#pac-man{
margin-left: 0px;
margin-right: 0px;
}
#funil{
    margin: -8px 16px 3px 16px;
}
#macs{
    width: 50px;
    height: 50px;
    margin: -6px 15px 0px 13px;

}
a{
    cursor: pointer;
    padding: 8px;
}



    /* Estilo para a notifica√ß√£o de c√≥pia */
    .copy-alert {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border-radius: 5px;
        font-size: 1em;
        opacity: 0;
        transition: opacity 0.3s ease, transform 0.3s ease;
        transform: translateY(-20px);
        z-index: 1000;
    }
    .copy-alert.show {
        opacity: 1;
        transform: translateY(0);
    }

    /* Estilos para os bot√µes de exportar/importar */
    .export-import-buttons {
    display: flex;
    justify-content: space-between;
    gap: 2%; /* Reduzi o gap para 2% */
    margin: 5px 0 10px 0;
    width: 100%;
}
    
.export-btn {
    background-color: #4CAF50;
    padding: 12px;
    font-size: 1.1em;
    width: 100%; /* Garante que o bot√£o ocupa todo o container */
    display: flex;
    align-items: center;
    justify-content: center;
}
    
.import-btn {
    background-color: #2196F3;
    padding: 12px;
    font-size: 1.1em;
    width: 49%; /* Definindo largura fixa de 48% */
    display: flex;
    align-items: center;
    justify-content: center;
}
    
    .file-input {
        display: none;
    }

    /* Modal de exporta√ß√£o */
    .export-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.7);
        z-index: 1001;
        justify-content: center;
        align-items: center;
    }
    
    .export-modal-content {
        background-color: #12233d;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 500px;
        color: white;
        text-align: center;
    }
    
    .export-modal h3 {
        margin-bottom: 15px;
        font-size: 1.5em;
        color: #ff9100;
    }
    
    .export-modal p {
        margin-bottom: 20px;
        font-size: 1em;
    }
    
    .export-modal-note {
        background-color: #1a3a6a;
        padding: 10px;
        border-radius: 5px;
        margin: 15px 0;
        font-size: 1em;
        border-left: 4px solid #ff9100;
    }
    
    .export-modal-buttons {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
    }
    
    .export-modal-btn {
        padding: 10px 15px;
        border: none;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
    }
    
    .export-pdf-btn {
        background-color: #e74c3c;
        color: white;
    }
    
    .export-excel-btn {
        background-color: #2ecc71;
        color: white;
    }
    
    .export-both-btn {
        background-color: #3498db;
        color: white;
    }
    
    .export-cancel-btn {
        background-color: #95a5a6;
        color: white;
    }
    
    .export-modal-input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
        border: none;
        font-size: 1em;
    }
    /* √çcone de notifica√ß√£o */
    .export-notification {
    position: absolute;
    top: -5px;
    right: -5px;
    background-color: #ff0000;
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 12px;
    font-weight: bold;
}
    .export-btn-container {
    position: relative;
    width: 49%; /* Alterei de flex:1 para width:48% */
    }
    
    .export-btn.has-notification {
        position: relative;
    }


    @media (max-width: 700px) {
    .container {
        width: 100%;
    }
    h1 {
        font-size: 1.8em;
    }
    input[type="text"], .search-box, button {
        font-size: 0.9em;
        padding: 10px;
    }
    .data-list th, .data-list td {
        font-size: 0.8em;
        padding: 6px;
    }




.catalogo {
    display: flex;
    gap: 3px;
    margin-left: -5px;
}
section {
    background-color:rgb(42, 99, 45); /* Azul forte */
    padding: 1px;
    display: flex;
    border: 1px solid #333; /* Borda para destaque */
    color: #fff; /* Cor do texto para contraste */
    border-radius: px;
}
section a {
    text-decoration: none;
    color: #ffffff;
    font-size: 8px;
}
.icon {
    width: 25px;
    height: 25px;

}

.sug a{
font-size: 8px;
}
#fatu{
    width: 23px;
    height: 23px;
    margin-bottom: 3px;
    margin-top: -0px;
}
.foto{
    width: 26px;
    height: 26px;
    margin-top: 0px;
}
#pac-man{
margin-left: 0px;
margin-right: 0px;
}
#macs{
    width: 26px;
    height: 26px;
margin-left: 2px;
margin-right: 2px;
margin-top: -2px;
}
#img img{
    width: 45px;
    height: 30px;
    margin-top: -4px;
    margin-left: 3px;
    margin-right: 3px;
}
a{
    cursor: pointer;
    padding: 0px;
}



    .export-modal-buttons {
        flex-direction: column;
    }
    
    .export-modal-btn {
        width: 100%;
    }
    }

/* Responsividade para telas menores */
    @media (max-width: 600px) {
            h1 {
                font-size: 1.3em;
            }

            .add-btn {
                font-size: 1.2em;
            }

            .data-list {
                font-size: 0.8em;
            }

            .data-list th, .data-list td {
                padding: 6px;
            }

            button {
            padding: 10px;
            font-size: .7em;
        }

        .delete-btn {
            margin-top: 5px;
            padding: 7px 10px;
        }

        
    .catalogo {
        display: flex;
        gap: 2px;
    }

    .sug {
        margin-left: 0px;
        margin-right: 0px;
    }

    section {
        background-color:rgb(42, 99, 45);
        padding: 3px;
        display: flex;
        border: 1px solid #333;
        color: #fff;
        border-radius: 7px;
    }

    section a {
        text-decoration: none;
        color: #ffffff;
        font-size: 9px;
    }

    .icon {
        width: 24px;
        height: 24px;
        margin: 0px 10px 0px 10px;
    }

    #pac-man, #macs {
        margin-left: 15px;
        margin-right: 15px;
    }

    #funil{
        width: 30px;
        height: 27px;
    margin: -2px 13px 2px 13px;
    }

    #macs{
    margin: 0px 10px 0px 10px;
    }

    .export-modal-note {
        font-size: .7em;
    }


    }


</style>


</head>
<body>
    <div id="copyAlert" class="copy-alert"></div>
    <div class="container">


    <div class="catalogo">
            <section class="sug">
                <a href="https://facilitaplay.vercel.app" target="_blank">
                    <img src="facilitador.png" alt="√çcone Sugest√£o" class="icon">
                    FACILITADOR</a>
            </section>
            <section>
                <a href="https://gerenciador-seven.vercel.app" target="_blank">
                    <img src="anuidade.png" alt="√çcone Gerenciador" class="icon">
                    Anuidade
                </a>
            </section>
            <section>
                <a href="https://sistema-sorteio.vercel.app" target="_blank">
                    <img id="macs" src="sorteio.png" alt="√çcone Organiza√ß√£o" class="icon"> <br>
                    Sorteador
                </a>
            </section>
            <section>
                <a id="img" href="https://indicaco-es.vercel.app" target="_blank">
                    <img id="pac-man" src="bonus.png" alt="√çcone Papa Teste" class="icon fotos"> <br>
                    Indica√ß√£o
                </a>
            </section>
            <section>
                <a href="https://funil-vznplay.vercel.app" target="_blank">
                    <img id="funil" src="funil.webp" alt="√çcone Papa Teste" class="icon foto"> <br>
                    Funil Vendas
                </a>
            </section>
            <section>
                <a href="https://planilhadefaturamneto.vercel.app" target="_blank">
                    <img id="fatu" src="faturamento.png" alt="√çcone Facilitador" class="icon">
                    Faturamento
                </a>
            </section>
    </div><br>

<h1>Cadastro De Mac's - VznPlay</h1>

    <form id="clientForm">

            <div class="row">
            <input type="text" id="nome" maxlength="20" placeholder="Nome Do Cliente" required>
            <input type="text" id="app" maxlength="15" placeholder="Nome do aplicativo" required>
            </div>

            <div class="row">
                <input type="text" id="mac" placeholder="Mac do cliente" maxlength="17" required oninput="formatarMac()">
                <input type="text" id="key" maxlength="7" placeholder="Chave Key" required>
            </div>
            <button type="button" class="add-btn" onclick="adicionarCliente()">Adicionar</button>
            <p class="success-message" id="successMessage">Usu√°rio adicionado!</p>
    </form>

    <input type="text" id="search" class="search-box" placeholder="Pesquisar Cliente">




    <!-- Faixa de texto rolante 
    <div class="banner">
        <div class="marquee">
            <div class="marquee-container">
                <span class="marquee-text">üöÄ Automatize Suas Vendas Com O WA Sender Clique Em <a href="https://wasenderplus.vercel.app" target="_blank">SAIBA MAIS!</a></span> <span class="marquee-text">üöÄ Multiplique Seus Ganhos E Transforme Seu WhatsApp Em Uma M√°quina De Vendas! <a href="https://wasenderplus.vercel.app" target="_blank">CLIQUE AQUI</a></span>

                // Duplicamos os textos para criar o loop perfeito //

                <span class="marquee-text">üöÄ Automatize Suas Vendas Com O WA Sender Clique Em <a href="https://wasenderplus.vercel.app" target="_blank">SAIBA MAIS!</a></span> <span class="marquee-text">üöÄ Multiplique Seus Ganhos E Transforme Seu WhatsApp Em Uma M√°quina De Vendas! <a href="https://wasenderplus.vercel.app" target="_blank">CLIQUE AQUI</a></span>
            </div>
        </div>
    </div>
-->




<!-- Bot√µes de Exportar/Importar -->
<div class="export-import-buttons">
    <div class="export-btn-container">
        <button id="exportButton" class="export-btn" onclick="showExportModal()">Exportar Dados</button>
        <div id="exportNotification" class="export-notification" style="display: none;">!</div>
    </div>
    
    <button class="import-btn" onclick="document.getElementById('fileInput').click()">Importar Dados</button>
    <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls" onchange="importarDados(event)">
</div>


<!-- Modal de Exporta√ß√£o -->
<div id="exportModal" class="export-modal">
    <div class="export-modal-content">
        <h3>Exportar Dados</h3>
        <p>Selecione o formato para exporta√ß√£o:</p>
        
        <input type="text" id="exportName" class="export-modal-input" placeholder="Digite Um Nome Para O PDF">
        
        <div class="export-modal-note">
            <strong>Importante:</strong> Para um backup seguro, recomenda-se o download em formato Excel, pois ele permite a importa√ß√£o dos dados caso seja necess√°rio restaur√°-los futuramente. J√° o formato PDF √© ideal para visualiza√ß√£o e impress√£o.
        </div>
        
        <div class="export-modal-buttons">
            <button class="export-modal-btn export-pdf-btn" onclick="exportarParaPDF()">Salvar em PDF</button>
            <button class="export-modal-btn export-excel-btn" onclick="exportarParaExcel()">Salvar em Excel</button>
            <button class="export-modal-btn export-both-btn" onclick="exportarAmbos()">Salvar Ambos</button>
            <button class="export-modal-btn export-cancel-btn" onclick="hideExportModal()">Cancelar</button>
        </div>
    </div>
</div>

<div class="data-list" id="clientList">
            <h2>Lista de Clientes</h2>
            <table>
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Apps</th>
                        <th>MAC</th>
                        <th>Key</th>
                        <th>Deletar</th>
                    </tr>
                </thead>
                <tbody id="clientTableBody"></tbody>
            </table>
</div>
</div>

<script>
        // Inicializa o jsPDF
        const { jsPDF } = window.jspdf;
        
        const clients = JSON.parse(localStorage.getItem('clients')) || [];
        let hasUnsavedChanges = false;

function adicionarCliente() {
    const nome = document.getElementById('nome').value;
    const app = document.getElementById('app').value;
    const mac = document.getElementById('mac').value;
    const key = document.getElementById('key').value;

    if (!nome || !app || !mac || !key) {
        alert('Preencha todos os campos.');
        return;
    }

    const client = { nome, app, mac, key };
    clients.push(client);

    localStorage.setItem('clients', JSON.stringify(clients));
    localStorage.setItem('hasUnsavedChanges', 'true');
    atualizarTabela();
    document.getElementById('clientForm').reset();
    document.getElementById('successMessage').style.display = 'block';

    // Marca que h√° altera√ß√µes n√£o salvas
    hasUnsavedChanges = true;
    updateExportButtonNotification();

    setTimeout(() => {
        document.getElementById('successMessage').style.display = 'none';
    }, 2000);
}

function atualizarTabela() {
    const clientTableBody = document.getElementById('clientTableBody');
    clientTableBody.innerHTML = '';

    clients.forEach((client, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td onclick="copiarTexto('${client.nome}', 'Nome')">${client.nome}</td>
            <td onclick="copiarTexto('${client.app}', 'App')">${client.app}</td>
            <td onclick="copiarTexto('${client.mac}', 'MAC')">${client.mac}</td>
            <td onclick="copiarTexto('${client.key}', 'Key')">${client.key}</td>
            <td><button class="delete-btn" onclick="deletarCliente(${index})">Deletar</button></td>
        `;
        clientTableBody.appendChild(row);
    });
}

function deletarCliente(index) {
    clients.splice(index, 1);
    localStorage.setItem('clients', JSON.stringify(clients));
    localStorage.setItem('hasUnsavedChanges', 'true'); 
    atualizarTabela();
    
    // Marca que h√° altera√ß√µes n√£o salvas
    hasUnsavedChanges = true;
    updateExportButtonNotification();
}

function formatarMac() {
    const macInput = document.getElementById('mac');
    let mac = macInput.value.replace(/[^a-fA-F0-9]/g, '').toUpperCase();
    mac = mac.match(/.{1,2}/g)?.join(':') || mac;
    macInput.value = mac.substring(0, 17);
}

function copiarTexto(texto, tipo) {
    navigator.clipboard.writeText(texto).then(() => {
        mostrarAlerta(`${tipo} copiado`);
    }).catch(err => {
        console.error('Erro ao copiar texto: ', err);
    });
}

function mostrarAlerta(mensagem) {
    const alertDiv = document.getElementById('copyAlert');
    alertDiv.textContent = mensagem;
    alertDiv.classList.add('show');

    setTimeout(() => {
        alertDiv.classList.remove('show');
    }, 3000);
}

document.getElementById('search').addEventListener('input', function () {
    const searchTerm = this.value.toLowerCase();
    const rows = document.querySelectorAll('#clientTableBody tr');
    rows.forEach(row => {
        const isVisible = row.innerText.toLowerCase().includes(searchTerm);
        row.style.display = isVisible ? '' : 'none';
    });
});

// Fun√ß√£o para mostrar o modal de exporta√ß√£o
function showExportModal() {
    document.getElementById('exportModal').style.display = 'flex';
}

// Fun√ß√£o para esconder o modal de exporta√ß√£o
function hideExportModal() {
    document.getElementById('exportModal').style.display = 'none';
}

// Fun√ß√£o para atualizar a notifica√ß√£o no bot√£o de exporta√ß√£o
function updateExportButtonNotification() {
    const notification = document.getElementById('exportNotification');
    if (hasUnsavedChanges) {
        notification.style.display = 'flex';
        document.getElementById('exportButton').style.backgroundColor = '#4CAF50';
    } else {
        notification.style.display = 'none';
        document.getElementById('exportButton').style.backgroundColor = '#4CAF50';
    }
}

// Fun√ß√£o para exportar para PDF
function exportarParaPDF() {
    const doc = new jsPDF();
    const exportName = document.getElementById('exportName').value || 'VznPlay';
    
    // T√≠tulo do documento com o nome personalizado
    doc.text(`Lista de Clientes - ${exportName}`, 14, 15);
    
    // Cabe√ßalhos da tabela
    const headers = [["Nome", "App", "MAC", "Key"]];
    
    // Dados da tabela
    const data = clients.map(client => [client.nome, client.app, client.mac, client.key]);
    
    // Adiciona a tabela ao PDF
    doc.autoTable({
        head: headers,
        body: data,
        startY: 20,
        styles: {
            halign: 'center',
            cellPadding: 2,
            fontSize: 8
        },
        headStyles: {
            fillColor: [255, 145, 0],
            textColor: 0
        }

    });
    
    // Rodap√© do PDF
    const date = new Date();
    const footerText = `Relat√≥rio PDF gerado pelo Gerenciador de MACs ‚Äì VznPlay ¬© ${date.getFullYear()} | Todos os direitos reservados.`;
    doc.setFontSize(8);
    doc.text(footerText, 14, doc.internal.pageSize.height - 10);
    
    // Salva o PDF
    doc.save(`Mac_Clientes.pdf`);
    
    // Marca que as altera√ß√µes foram salvas
    hasUnsavedChanges = false;
    updateExportButtonNotification();
    hideExportModal();

    localStorage.setItem('hasUnsavedChanges', 'false');
    hasUnsavedChanges = false;
    updateExportButtonNotification();
}

// Fun√ß√£o para exportar para Excel
function exportarParaExcel() {
    // Cria uma nova workbook
    const wb = XLSX.utils.book_new();
    
    // Converte os dados para uma worksheet
    const ws = XLSX.utils.json_to_sheet(clients);
    
    // Adiciona a worksheet √† workbook
    XLSX.utils.book_append_sheet(wb, ws, "Clientes");
    
    // Salva o arquivo Excel
    XLSX.writeFile(wb, 'Mac_Clientes.xlsx');
    
    // Marca que as altera√ß√µes foram salvas
    hasUnsavedChanges = false;
    updateExportButtonNotification();
    hideExportModal();

    localStorage.setItem('hasUnsavedChanges', 'false');
    hasUnsavedChanges = false;
    updateExportButtonNotification();

}

// Fun√ß√£o para exportar para ambos os formatos
function exportarAmbos() {
    exportarParaPDF();
    setTimeout(() => {
        exportarParaExcel();
    }, 500);

    localStorage.setItem('hasUnsavedChanges', 'false');
    hasUnsavedChanges = false;
    updateExportButtonNotification();

}

// Fun√ß√£o para importar dados
function importarDados(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = function(e) {
        const data = e.target.result;
        importarDeExcel(data);
    };
    
    reader.readAsArrayBuffer(file);
}

// Fun√ß√£o para importar de Excel
function importarDeExcel(data) {
    try {
        const workbook = XLSX.read(data, { type: 'array' });
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];
        
        // Converter para JSON
        const jsonData = XLSX.utils.sheet_to_json(worksheet);
        
        if (jsonData.length > 0) {
            // Verifica se os dados t√™m a estrutura esperada
            const primeiroItem = jsonData[0];
            if (primeiroItem.nome && primeiroItem.app && primeiroItem.mac && primeiroItem.key) {
                // Limpa os clientes existentes e adiciona os novos
                clients.length = 0;
                jsonData.forEach(item => {
                    clients.push({
                        nome: item.nome,
                        app: item.app,
                        mac: item.mac,
                        key: item.key
                    });
                });
                
                localStorage.setItem('clients', JSON.stringify(clients));
                atualizarTabela();
                mostrarAlerta("Dados importados com sucesso!");
                
                // Marca que h√° altera√ß√µes n√£o salvas (pois foram importados novos dados)
                hasUnsavedChanges = true;
                updateExportButtonNotification();
            } else {
                alert("O arquivo Excel n√£o tem o formato esperado. Certifique-se de que cont√©m as colunas: nome, app, mac e key.");
            }
        } else {
            alert("O arquivo Excel est√° vazio.");
        }
    } catch (error) {
        console.error("Erro ao importar dados:", error);
        alert("Ocorreu um erro ao importar os dados. Verifique o arquivo e tente novamente.");
    }
}

// Verifica se h√° altera√ß√µes n√£o salvas ao carregar a p√°gina
window.addEventListener('load', function() {
    // Verifica o flag no localStorage
    hasUnsavedChanges = localStorage.getItem('hasUnsavedChanges') === 'true';
    updateExportButtonNotification();
});

atualizarTabela();
</script>

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js');
  }
</script>


</body>
</html>